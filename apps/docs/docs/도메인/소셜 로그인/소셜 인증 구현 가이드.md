---
sidebar_position: 3
---

# 소셜 인증 구현 가이드

## 개요

우리 서비스의 소셜 인증은 NestJS와 Passport.js를 활용하여 구현됩니다. 멘토와 멘티에 대해 서로 다른 인증 흐름을 제공하여, 각 역할에 맞는 적절한 회원가입과 로그인 프로세스를 지원합니다.

## 인증 흐름

### 멘티 소셜 로그인 흐름

1. 멘티가 소셜 로그인 버튼 클릭
2. OAuth 제공자의 동의 화면으로 이동
3. 사용자 동의 후 서비스로 리다이렉트
4. 최초 로그인인 경우:
   - 백준 ID 입력 요청
   - 전화번호 인증 진행
5. 계정 생성 및 로그인 처리

### 멘토 소셜 로그인 흐름

1. 멘토가 소셜 로그인 버튼 클릭
2. OAuth 제공자의 동의 화면으로 이동
3. 사용자 동의 후 서비스로 리다이렉트
4. 최초 로그인인 경우:
   - 백준 ID 입력 및 티어 검증 (Platinum 3 이상)
   - 전화번호 인증 진행
   - 멘토 프로필 정보 입력
   - 관리자 승인 대기 상태로 전환
5. 승인 완료된 경우에만 로그인 허용

## 기술 스택

- NestJS: 백엔드 프레임워크
- Passport.js: 인증 미들웨어
- JWT: 토큰 기반 인증
- Redis: 상태 관리 및 세션 저장

## 주요 구현 포인트

### 1. OAuth 전략 분리

멘토와 멘티를 위한 별도의 Passport 전략을 구현하여, 각각의 인증 흐름을 독립적으로 관리합니다.

```typescript
// 예시: 멘토와 멘티를 위한 별도의 Google OAuth 전략
passport.use('mentor-google', ...);
passport.use('mentee-google', ...);
```

### 2. 보안 고려사항

- CSRF 토큰을 사용하여 요청 위조 방지
- 상태 관리를 위한 안전한 저장소 사용 (Redis)
- 실패한 인증 시도 모니터링
- OAuth state 파라미터 검증

### 3. 실패 복구 전략

- 토큰 갱신 자동화
- 일시적인 네트워크 오류 대응을 위한 재시도 로직
- 예외 상황 로깅 및 모니터링

## 지원하는 소셜 로그인 제공자

- Google
- Naver
- Kakao

각 제공자별 구현은 동일한 인터페이스를 따르되, 제공자의 특성에 맞게 커스터마이즈됩니다.

## 향후 개선 사항

1. 소셜 계정 연동/해제 기능
2. 추가 OAuth 제공자 지원
3. 프로필 동기화 기능
4. 소셜 로그인 통계 및 분석

## 참고사항

이 구현은 NestJS의 공식 가이드와 Passport.js의 베스트 프랙티스를 따르고 있습니다. 자세한 구현 내용은 소스 코드의 주석과 API 문서를 참조하시기 바랍니다.
