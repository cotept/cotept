# Î™®ÎÖ∏Î†àÌè¨ Î∏åÎûúÏπò Í¥ÄÎ¶¨ Î∞è Î∞∞Ìè¨ Ï†ÑÎûµ Í∞ÄÏù¥Îìú

## üìã Î™©Ï∞®

- [Î™®ÎÖ∏Î†àÌè¨ Î∏åÎûúÏπò Ï†ÑÎûµ ÏòµÏÖò](#Î™®ÎÖ∏Î†àÌè¨-Î∏åÎûúÏπò-Ï†ÑÎûµ-ÏòµÏÖò)
- [Í∂åÏû• Ï†ÑÎûµ: Git Flow + Monorepo](#Í∂åÏû•-Ï†ÑÎûµ-git-flow--monorepo)
- [CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ ÏÑ§Ï†ï](#cicd-ÌååÏù¥ÌîÑÎùºÏù∏-ÏÑ§Ï†ï)
- [ÌôòÍ≤ΩÎ≥ÄÏàò Í¥ÄÎ¶¨ Ï†ÑÎûµ](#ÌôòÍ≤ΩÎ≥ÄÏàò-Í¥ÄÎ¶¨-Ï†ÑÎûµ)
- [Ïã§Ï†ú ÏõåÌÅ¨ÌîåÎ°úÏö∞](#Ïã§Ï†ú-ÏõåÌÅ¨ÌîåÎ°úÏö∞)
- [Î∞∞Ìè¨ ÌôòÍ≤Ω Íµ¨ÏÑ±](#Î∞∞Ìè¨-ÌôòÍ≤Ω-Íµ¨ÏÑ±)
- [Î™®ÎãàÌÑ∞ÎßÅ Î∞è Î°§Î∞±](#Î™®ÎãàÌÑ∞ÎßÅ-Î∞è-Î°§Î∞±)

## Î™®ÎÖ∏Î†àÌè¨ Î∏åÎûúÏπò Ï†ÑÎûµ ÏòµÏÖò

### 1. üìÅ Îã®Ïùº Î∏åÎûúÏπò Ï†ÑÎûµ (ÌòÑÏû¨ ÏÉÅÌô©)

```
main (Î™®Îì† ÏÑúÎπÑÏä§ ÌîÑÎ°úÎçïÏÖò)
‚îú‚îÄ‚îÄ development (Î™®Îì† ÏÑúÎπÑÏä§ Í∞úÎ∞ú)
‚îú‚îÄ‚îÄ feature/web-user-auth
‚îú‚îÄ‚îÄ feature/api-payment-module
‚îú‚îÄ‚îÄ feature/mobile-push-notification
‚îî‚îÄ‚îÄ hotfix/web-security-patch
```

**ÌòÑÏû¨ Íµ¨Ï°∞:**

- `main` ‚Üí ÌîÑÎ°úÎçïÏÖò (web + api)
- `development` ‚Üí Í∞úÎ∞ú/Ïä§ÌÖåÏù¥Ïßï (web + api)

**Ïû•Ï†ê:**

- Îã®ÏàúÌïú Íµ¨Ï°∞
- Î™®Îì† ÏÑúÎπÑÏä§ ÎèôÏãú Î∞∞Ìè¨ Í∞ÄÎä•
- ÌÜµÌï© ÌÖåÏä§Ìä∏ Ïö©Ïù¥

**Îã®Ï†ê:**

- Ìïú ÏÑúÎπÑÏä§ Î≤ÑÍ∑∏Í∞Ä Ï†ÑÏ≤¥ Î∞∞Ìè¨ Î∏îÎ°úÌÇπ
- ÏÑúÎπÑÏä§Î≥Ñ ÎèÖÎ¶ΩÏ†Å Î∞∞Ìè¨ Ïñ¥Î†§ÏõÄ
- Î∞∞Ìè¨ Ï£ºÍ∏∞Í∞Ä Í∞ÄÏû• ÎäêÎ¶∞ ÏÑúÎπÑÏä§Ïóê ÎßûÏ∂∞Ïßê

### 2. üè∑Ô∏è ÌÉúÍ∑∏ Í∏∞Î∞ò Î∞∞Ìè¨ Ï†ÑÎûµ

```
main
‚îú‚îÄ‚îÄ development
‚îú‚îÄ‚îÄ feature/web-dashboard
‚îú‚îÄ‚îÄ feature/api-auth-v2
‚îî‚îÄ‚îÄ release/web-v1.2.0
    release/api-v2.1.0
```

**ÌÉúÍ∑∏ ÏòàÏãú:**

- `web-v1.2.0` ‚Üí apps/web Î∞∞Ìè¨
- `api-v2.1.0` ‚Üí apps/api Î∞∞Ìè¨
- `shared-v1.0.0` ‚Üí packages ÎùºÏù¥Î∏åÎü¨Î¶¨ Î∞∞Ìè¨

**Ïû•Ï†ê:**

- ÏÑúÎπÑÏä§Î≥Ñ ÎèÖÎ¶ΩÏ†Å Î≤ÑÏ†Ñ Í¥ÄÎ¶¨
- ÏÑ†ÌÉùÏ†Å Î∞∞Ìè¨ Í∞ÄÎä•
- Î™ÖÌôïÌïú Î¶¥Î¶¨Ï¶à ÌûàÏä§ÌÜ†Î¶¨

**Îã®Ï†ê:**

- ÌÉúÍ∑∏ Í¥ÄÎ¶¨ Î≥µÏû°ÏÑ±
- ÏùòÏ°¥ÏÑ± Î≤ÑÏ†Ñ Ï∂©Îèå Í∞ÄÎä•ÏÑ±

### 3. üîÑ ÏÑúÎπÑÏä§Î≥Ñ ÎèÖÎ¶Ω Î∏åÎûúÏπò

```
main
‚îú‚îÄ‚îÄ web/main          (Ïõπ ÌîÑÎ°úÎçïÏÖò)
‚îú‚îÄ‚îÄ web/development   (Ïõπ Í∞úÎ∞ú)
‚îú‚îÄ‚îÄ api/main          (API ÌîÑÎ°úÎçïÏÖò)
‚îú‚îÄ‚îÄ api/development   (API Í∞úÎ∞ú)
‚îî‚îÄ‚îÄ shared/main       (Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨)
```

**Ïû•Ï†ê:**

- ÏôÑÏ†ÑÌïú ÏÑúÎπÑÏä§ ÎèÖÎ¶ΩÏÑ±
- Í∞Å ÌåÄÏùò ÏûêÏú®Ï†Å Î∞∞Ìè¨

**Îã®Ï†ê:**

- Î∏åÎûúÏπò Í¥ÄÎ¶¨ Î≥µÏû°ÏÑ± Ï¶ùÍ∞Ä
- Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨ ÎèôÍ∏∞Ìôî Ïñ¥Î†§ÏõÄ
- ÌÜµÌï© ÌÖåÏä§Ìä∏ Î≥µÏû°

## Í∂åÏû• Ï†ÑÎûµ: Git Flow + Monorepo

### Î∏åÎûúÏπò Íµ¨Ï°∞

```
main                    # Î™®Îì† ÏÑúÎπÑÏä§ ÏïàÏ†ï Î≤ÑÏ†Ñ
‚îú‚îÄ‚îÄ development         # ÌÜµÌï© Í∞úÎ∞ú Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ staging            # Ïä§ÌÖåÏù¥Ïßï Ï†ÑÏö© Î∏åÎûúÏπò (ÏÑ†ÌÉù)
‚îú‚îÄ‚îÄ feature/web-*       # Ïõπ Ïï± Í∏∞Îä• Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ feature/api-*       # API ÏÑúÎ≤Ñ Í∏∞Îä• Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ feature/shared-*    # Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨ Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ hotfix/*           # Í∏¥Í∏â ÏàòÏ†ï Î∏åÎûúÏπò
‚îî‚îÄ‚îÄ release/*          # Î¶¥Î¶¨Ïä§ Ï§ÄÎπÑ Î∏åÎûúÏπò
```

### Î∏åÎûúÏπòÎ≥Ñ Ïó≠Ìï†

#### `main` (ÌîÑÎ°úÎçïÏÖò)

- **Î™©Ï†Å**: ÌîÑÎ°úÎçïÏÖò ÌôòÍ≤Ω Î∞∞Ìè¨
- **Î≥¥Ìò∏ ÏÑ§Ï†ï**: ÏßÅÏ†ë push Í∏àÏßÄ, PRÎßå ÌóàÏö©
- **ÏûêÎèô Î∞∞Ìè¨**: ÌîÑÎ°úÎçïÏÖò ÏÑúÎ≤ÑÏóê ÏûêÎèô Î∞∞Ìè¨
- **ÌôòÍ≤Ω**: `NODE_ENV=production`

#### `development` (Í∞úÎ∞ú/ÌÜµÌï©)

- **Î™©Ï†Å**: Í∞úÎ∞ú ÏôÑÎ£åÎêú Í∏∞Îä• ÌÜµÌï©
- **ÏûêÎèô Î∞∞Ìè¨**: Ïä§ÌÖåÏù¥Ïßï ÏÑúÎ≤ÑÏóê ÏûêÎèô Î∞∞Ìè¨
- **ÌôòÍ≤Ω**: `NODE_ENV=development`
- **ÌÖåÏä§Ìä∏**: ÌÜµÌï© ÌÖåÏä§Ìä∏ Ïã§Ìñâ

#### `feature/*` (Í∏∞Îä• Í∞úÎ∞ú)

- **Î™ÖÎ™Ö Í∑úÏπô**:
  - `feature/web-user-dashboard` (Ïõπ Í∏∞Îä•)
  - `feature/api-auth-system` (API Í∏∞Îä•)
  - `feature/shared-validation` (Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨)
- **ÏÉùÏÑ± Í∏∞Ï§Ä**: `development`ÏóêÏÑú Î∂ÑÍ∏∞
- **Î®∏ÏßÄ ÎåÄÏÉÅ**: `development`Î°ú PR

#### `hotfix/*` (Í∏¥Í∏â ÏàòÏ†ï)

- **Î™ÖÎ™Ö Í∑úÏπô**: `hotfix/service-issue-description`
- **ÏÉùÏÑ± Í∏∞Ï§Ä**: `main`ÏóêÏÑú Î∂ÑÍ∏∞
- **Î®∏ÏßÄ ÎåÄÏÉÅ**: `main`Í≥º `development` ÏñëÏ™Ω

#### `release/*` (Î¶¥Î¶¨Ïä§ Ï§ÄÎπÑ)

- **Î™ÖÎ™Ö Í∑úÏπô**: `release/v1.2.0`
- **Î™©Ï†Å**: Î¶¥Î¶¨Ïä§ Ï†Ñ ÏµúÏ¢Ö Ï§ÄÎπÑ ÏûëÏóÖ
- **ÏÉùÏÑ± Í∏∞Ï§Ä**: `development`ÏóêÏÑú Î∂ÑÍ∏∞
- **Î®∏ÏßÄ ÎåÄÏÉÅ**: `main`ÏúºÎ°ú PR ÌõÑ `development`Ïóê Î∞±Ìè¨Ìä∏

### Î∏åÎûúÏπò Î≥¥Ìò∏ Í∑úÏπô

```yaml
# GitHub Î∏åÎûúÏπò Î≥¥Ìò∏ ÏÑ§Ï†ï
main:
  protection_rules:
    required_status_checks:
      - "test-web"
      - "test-api"
      - "build-web"
      - "build-api"
    enforce_admins: true
    required_pull_request_reviews:
      required_approving_review_count: 2
      dismiss_stale_reviews: true
    restrictions:
      push: false # ÏßÅÏ†ë push Í∏àÏßÄ

development:
  protection_rules:
    required_status_checks:
      - "test-web"
      - "test-api"
    required_pull_request_reviews:
      required_approving_review_count: 1
```

## CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ ÏÑ§Ï†ï

### GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞

#### Î≥ÄÍ≤Ω Í∞êÏßÄ Î∞è ÏÑúÎπÑÏä§Î≥Ñ Î∞∞Ìè¨

```yaml
# .github/workflows/deploy.yml
name: Deploy Services

on:
  push:
    branches: [main, development]
  pull_request:
    branches: [main, development]

env:
  NODE_VERSION: "18"
  PNPM_VERSION: "8"

jobs:
  # Î≥ÄÍ≤ΩÎêú ÏÑúÎπÑÏä§ Í∞êÏßÄ
  detect-changes:
    runs-on: ubuntu-latest
    outputs:
      web-changed: ${{ steps.changes.outputs.web }}
      api-changed: ${{ steps.changes.outputs.api }}
      shared-changed: ${{ steps.changes.outputs.shared }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Detect changes
        uses: dorny/paths-filter@v2
        id: changes
        with:
          filters: |
            web:
              - 'apps/web/**'
              - 'packages/**'
              - 'pnpm-lock.yaml'
            api:
              - 'apps/api/**'
              - 'packages/**'
              - 'pnpm-lock.yaml'
            shared:
              - 'packages/**'
              - 'pnpm-lock.yaml'

  # Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨ ÌÖåÏä§Ìä∏
  test-shared:
    needs: detect-changes
    if: needs.detect-changes.outputs.shared-changed == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: ${{ env.PNPM_VERSION }}
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "pnpm"

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Test shared packages
        run: pnpm test:shared

  # Ïõπ Ïï± ÌÖåÏä§Ìä∏ Î∞è ÎπåÎìú
  test-build-web:
    needs: detect-changes
    if: needs.detect-changes.outputs.web-changed == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: ${{ env.PNPM_VERSION }}
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "pnpm"

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Lint web app
        run: pnpm lint:web

      - name: Test web app
        run: pnpm test:web

      - name: Build web app
        run: pnpm build:web
        env:
          NODE_ENV: ${{ github.ref == 'refs/heads/main' && 'production' || 'development' }}

      - name: Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: web-build
          path: apps/web/.next

  # API ÏÑúÎ≤Ñ ÌÖåÏä§Ìä∏ Î∞è ÎπåÎìú
  test-build-api:
    needs: detect-changes
    if: needs.detect-changes.outputs.api-changed == 'true'
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: test
          POSTGRES_DB: test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: ${{ env.PNPM_VERSION }}
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "pnpm"

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Lint API
        run: pnpm lint:api

      - name: Test API
        run: pnpm test:api
        env:
          DATABASE_URL: postgresql://postgres:test@localhost:5432/test

      - name: Build API
        run: pnpm build:api

      - name: Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: api-build
          path: apps/api/dist

  # Ïõπ Ïï± Î∞∞Ìè¨
  deploy-web:
    needs: [detect-changes, test-build-web]
    if: needs.detect-changes.outputs.web-changed == 'true' && (github.ref == 'refs/heads/main' || github.ref == 'refs/heads/development')
    runs-on: ubuntu-latest
    environment: ${{ github.ref == 'refs/heads/main' && 'production' || 'staging' }}
    steps:
      - name: Download build artifacts
        uses: actions/download-artifact@v3
        with:
          name: web-build
          path: .next

      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: apps/web
          vercel-args: ${{ github.ref == 'refs/heads/main' && '--prod' || '' }}

  # API ÏÑúÎ≤Ñ Î∞∞Ìè¨
  deploy-api:
    needs: [detect-changes, test-build-api]
    if: needs.detect-changes.outputs.api-changed == 'true' && (github.ref == 'refs/heads/main' || github.ref == 'refs/heads/development')
    runs-on: ubuntu-latest
    environment: ${{ github.ref == 'refs/heads/main' && 'production' || 'staging' }}
    steps:
      - name: Download build artifacts
        uses: actions/download-artifact@v3
        with:
          name: api-build
          path: dist

      - name: Deploy to production server
        if: github.ref == 'refs/heads/main'
        run: |
          echo "Deploying API to production server"
          # Ïã§Ï†ú Î∞∞Ìè¨ Î™ÖÎ†πÏñ¥ Ï∂îÍ∞Ä
          # ssh, rsync, ÎòêÎäî Ïª®ÌÖåÏù¥ÎÑà Î∞∞Ìè¨

      - name: Deploy to staging server
        if: github.ref == 'refs/heads/development'
        run: |
          echo "Deploying API to staging server"
          # Ïã§Ï†ú Î∞∞Ìè¨ Î™ÖÎ†πÏñ¥ Ï∂îÍ∞Ä
```

### Î∞∞Ìè¨ ÌôòÍ≤ΩÎ≥Ñ ÏõåÌÅ¨ÌîåÎ°úÏö∞

#### Ïä§ÌÖåÏù¥Ïßï Î∞∞Ìè¨ (development Î∏åÎûúÏπò)

```yaml
# .github/workflows/staging.yml
name: Deploy to Staging

on:
  push:
    branches: [development]

jobs:
  deploy-staging:
    runs-on: ubuntu-latest
    environment: staging
    steps:
      - uses: actions/checkout@v4

      - name: Setup environment
        run: |
          echo "NODE_ENV=development" >> $GITHUB_ENV
          echo "DEPLOY_ENV=staging" >> $GITHUB_ENV

      - name: Deploy web to staging
        run: |
          # Vercel staging Î∞∞Ìè¨
          vercel --token ${{ secrets.VERCEL_TOKEN }} --scope ${{ secrets.VERCEL_ORG_ID }}

      - name: Deploy API to staging
        run: |
          # Ïä§ÌÖåÏù¥Ïßï ÏÑúÎ≤Ñ Î∞∞Ìè¨
          ssh user@staging-server "cd /var/www/api && git pull && npm run build && pm2 restart api"

      - name: Run smoke tests
        run: |
          # Í∏∞Î≥∏ Ìó¨Ïä§Ï≤¥ÌÅ¨
          curl -f https://staging-web.myapp.com/health
          curl -f https://staging-api.myapp.com/health
```

#### ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ (main Î∏åÎûúÏπò)

```yaml
# .github/workflows/production.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  deploy-production:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - uses: actions/checkout@v4

      - name: Setup environment
        run: |
          echo "NODE_ENV=production" >> $GITHUB_ENV
          echo "DEPLOY_ENV=production" >> $GITHUB_ENV

      - name: Deploy web to production
        run: |
          # Vercel ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨
          vercel --prod --token ${{ secrets.VERCEL_TOKEN }}

      - name: Deploy API to production
        run: |
          # ÌîÑÎ°úÎçïÏÖò ÏÑúÎ≤Ñ Î∞∞Ìè¨ (Blue-Green ÎòêÎäî Rolling Update)
          ./scripts/deploy-api-production.sh

      - name: Run health checks
        run: |
          # ÌîÑÎ°úÎçïÏÖò Ìó¨Ïä§Ï≤¥ÌÅ¨
          curl -f https://myapp.com/health
          curl -f https://api.myapp.com/health

      - name: Notify deployment
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          channel: "#deployments"
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

## ÌôòÍ≤ΩÎ≥ÄÏàò Í¥ÄÎ¶¨ Ï†ÑÎûµ

### 1. ÏÑúÎπÑÏä§Î≥Ñ ÌôòÍ≤ΩÎ≥ÄÏàò Íµ¨Ï°∞

```
project-root/
‚îú‚îÄ‚îÄ .env.example                    # Ï†ÑÏ≤¥ ÌîÑÎ°úÏ†ùÌä∏ ÌÖúÌîåÎ¶ø
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .env.example           # Ïõπ Ïï± ÌÖúÌîåÎ¶ø
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .env.development       # Ïõπ Í∞úÎ∞ú ÏÑ§Ï†ï
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .env.production        # Ïõπ ÌîÑÎ°úÎçïÏÖò Í≥µÍ∞ú ÏÑ§Ï†ï
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .env.local            # Ïõπ Î°úÏª¨ ÎπÑÎ∞Ä ÏÑ§Ï†ï (Git Ï†úÏô∏)
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îú‚îÄ‚îÄ .env.example          # API ÌÖúÌîåÎ¶ø
‚îÇ       ‚îú‚îÄ‚îÄ .env.development      # API Í∞úÎ∞ú ÏÑ§Ï†ï
‚îÇ       ‚îú‚îÄ‚îÄ .env.production       # API ÌîÑÎ°úÎçïÏÖò Í≥µÍ∞ú ÏÑ§Ï†ï
‚îÇ       ‚îî‚îÄ‚îÄ .env.local           # API Î°úÏª¨ ÎπÑÎ∞Ä ÏÑ§Ï†ï (Git Ï†úÏô∏)
‚îî‚îÄ‚îÄ packages/
    ‚îî‚îÄ‚îÄ shared/
        ‚îî‚îÄ‚îÄ .env.example         # Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨ ÌÖúÌîåÎ¶ø
```

### 2. ÌôòÍ≤ΩÎ≥Ñ ÏÑ§Ï†ï ÏòàÏãú

#### Ïõπ Ïï± ÌôòÍ≤ΩÎ≥ÄÏàò

```bash
# apps/web/.env.development
NEXT_PUBLIC_APP_NAME=CoTept
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_WEB_URL=http://localhost:3000
NEXT_PUBLIC_ENV=development
NEXT_PUBLIC_SENTRY_DSN=

# apps/web/.env.production
NEXT_PUBLIC_APP_NAME=CoTept
NEXT_PUBLIC_API_URL=https://api.myapp.com
NEXT_PUBLIC_WEB_URL=https://myapp.com
NEXT_PUBLIC_ENV=production
NEXT_PUBLIC_SENTRY_DSN=https://your-sentry-dsn

# apps/web/.env.local (Git Ï†úÏô∏)
NEXTAUTH_SECRET=your-nextauth-secret
NEXTAUTH_URL=http://localhost:3000
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
```

#### API ÏÑúÎ≤Ñ ÌôòÍ≤ΩÎ≥ÄÏàò

```bash
# apps/api/.env.development
NODE_ENV=development
PORT=3001
CORS_ORIGINS=http://localhost:3000
LOG_LEVEL=debug

# apps/api/.env.production
NODE_ENV=production
PORT=3001
CORS_ORIGINS=https://myapp.com
LOG_LEVEL=info

# apps/api/.env.local (Git Ï†úÏô∏)
DATABASE_URL=postgresql://user:password@localhost:5432/cotept_dev
REDIS_URL=redis://localhost:6379
JWT_SECRET=your-jwt-secret
SMTP_PASSWORD=your-smtp-password
GITHUB_TOKEN=your-github-token
```

### 3. GitHub Secrets Íµ¨Ï°∞

```yaml
# Repository Secrets
secrets:
  # Í≥µÌÜµ ÏÑ§Ï†ï
  VERCEL_TOKEN: "vercel-token"
  VERCEL_ORG_ID: "team-id"
  SLACK_WEBHOOK: "slack-webhook-url"

  # Ïõπ Ïï± Í¥ÄÎ†®
  VERCEL_WEB_PROJECT_ID: "web-project-id"
  NEXTAUTH_SECRET: "nextauth-secret"
  GOOGLE_CLIENT_ID: "google-client-id"
  GOOGLE_CLIENT_SECRET: "google-client-secret"

  # API Í¥ÄÎ†®
  DATABASE_URL: "postgresql://..."
  REDIS_URL: "redis://..."
  JWT_SECRET: "jwt-secret"
  SMTP_PASSWORD: "smtp-password"

  # ÌôòÍ≤ΩÎ≥Ñ Íµ¨Î∂Ñ
  STAGING_DATABASE_URL: "postgresql://staging..."
  PRODUCTION_DATABASE_URL: "postgresql://production..."

# Environment Secrets (production, staging)
production:
  NEXT_PUBLIC_SENTRY_DSN: "prod-sentry-dsn"
  DATABASE_URL: "prod-database-url"

staging:
  NEXT_PUBLIC_SENTRY_DSN: "staging-sentry-dsn"
  DATABASE_URL: "staging-database-url"
```

## Ïã§Ï†ú ÏõåÌÅ¨ÌîåÎ°úÏö∞

### ÏùºÎ∞òÏ†ÅÏù∏ Í∞úÎ∞ú Í≥ºÏ†ï

```bash
# 1. ÏÉà Í∏∞Îä• Í∞úÎ∞ú ÏãúÏûë
git checkout development
git pull origin development
git checkout -b feature/web-user-profile

# 2. Í∞úÎ∞ú ÏûëÏóÖ
# apps/web/src/components/UserProfile.tsx Í∞úÎ∞ú
# ÌÖåÏä§Ìä∏ ÏΩîÎìú ÏûëÏÑ±
# Î°úÏª¨ ÌÖåÏä§Ìä∏

# 3. Ïª§Î∞ã Î∞è Ìë∏Ïãú
git add .
git commit -m "feat(web): add user profile component"
git push origin feature/web-user-profile

# 4. Pull Request ÏÉùÏÑ±
# GitHubÏóêÏÑú feature/web-user-profile ‚Üí development PR ÏÉùÏÑ±
# ÏΩîÎìú Î¶¨Î∑∞ ÏöîÏ≤≠
# CI ÌÖåÏä§Ìä∏ ÌÜµÍ≥º ÌôïÏù∏

# 5. Î®∏ÏßÄ ÌõÑ Ïä§ÌÖåÏù¥Ïßï Î∞∞Ìè¨
# PR Î®∏ÏßÄ ‚Üí development Î∏åÎûúÏπò ÏóÖÎç∞Ïù¥Ìä∏
# ÏûêÎèôÏúºÎ°ú Ïä§ÌÖåÏù¥Ïßï ÌôòÍ≤ΩÏóê Î∞∞Ìè¨
# QA ÌåÄ ÌÖåÏä§Ìä∏

# 6. ÌîÑÎ°úÎçïÏÖò Î¶¥Î¶¨Ïä§
git checkout main
git pull origin main
git merge development
git push origin main
# ÏûêÎèôÏúºÎ°ú ÌîÑÎ°úÎçïÏÖò ÌôòÍ≤ΩÏóê Î∞∞Ìè¨
```

### Í∏¥Í∏â ÏàòÏ†ï (Hotfix) Í≥ºÏ†ï

```bash
# 1. ÌîÑÎ°úÎçïÏÖò Ïù¥Ïäà Î∞úÍ≤¨
# main Î∏åÎûúÏπòÏóêÏÑú Ìï´ÌîΩÏä§ Î∏åÎûúÏπò ÏÉùÏÑ±
git checkout main
git pull origin main
git checkout -b hotfix/web-security-vulnerability

# 2. Í∏¥Í∏â ÏàòÏ†ï
# Î≥¥Ïïà Ï∑®ÏïΩÏ†ê ÏàòÏ†ï
# ÌÖåÏä§Ìä∏ ÏûëÏÑ± Î∞è Í≤ÄÏ¶ù

# 3. Îπ†Î•∏ Î∞∞Ìè¨
git add .
git commit -m "fix(web): resolve security vulnerability"
git push origin hotfix/web-security-vulnerability

# 4. mainÏóê ÏßÅÏ†ë Î®∏ÏßÄ (Í∏¥Í∏â)
git checkout main
git merge hotfix/web-security-vulnerability
git push origin main
# Ï¶âÏãú ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨

# 5. developmentÏóê Î∞±Ìè¨Ìä∏
git checkout development
git merge hotfix/web-security-vulnerability
git push origin development

# 6. Ìï´ÌîΩÏä§ Î∏åÎûúÏπò Ï†ïÎ¶¨
git branch -d hotfix/web-security-vulnerability
git push origin --delete hotfix/web-security-vulnerability
```

### Î¶¥Î¶¨Ïä§ Í≥ºÏ†ï (ÎåÄÍ∑úÎ™® ÏóÖÎç∞Ïù¥Ìä∏)

```bash
# 1. Î¶¥Î¶¨Ïä§ Î∏åÎûúÏπò ÏÉùÏÑ±
git checkout development
git pull origin development
git checkout -b release/v2.0.0

# 2. Î¶¥Î¶¨Ïä§ Ï§ÄÎπÑ ÏûëÏóÖ
# Î≤ÑÏ†Ñ ÏóÖÎç∞Ïù¥Ìä∏ (package.json)
# CHANGELOG.md ÏóÖÎç∞Ïù¥Ìä∏
# ÏµúÏ¢Ö ÌÖåÏä§Ìä∏
# Î¨∏ÏÑú ÏóÖÎç∞Ïù¥Ìä∏

# 3. Î¶¥Î¶¨Ïä§ Î∏åÎûúÏπòÏóêÏÑú ÏµúÏ¢Ö Í≤ÄÏ¶ù
git add .
git commit -m "chore: prepare release v2.0.0"
git push origin release/v2.0.0

# 4. mainÏúºÎ°ú Î®∏ÏßÄ
git checkout main
git merge release/v2.0.0
git tag v2.0.0
git push origin main
git push origin v2.0.0

# 5. developmentÏóê Î∞±Ìè¨Ìä∏
git checkout development
git merge release/v2.0.0
git push origin development

# 6. Î¶¥Î¶¨Ïä§ Î∏åÎûúÏπò Ï†ïÎ¶¨
git branch -d release/v2.0.0
git push origin --delete release/v2.0.0
```

## Î∞∞Ìè¨ ÌôòÍ≤Ω Íµ¨ÏÑ±

### ÌôòÍ≤Ω Íµ¨Î∂Ñ

| ÌôòÍ≤Ω         | Î∏åÎûúÏπò      | ÎèÑÎ©îÏù∏            | Î™©Ï†Å              |
| ------------ | ----------- | ----------------- | ----------------- |
| **Î°úÏª¨**     | feature/\*  | localhost:3000    | Í∞úÎ∞úÏûê Î°úÏª¨ Í∞úÎ∞ú  |
| **Ïä§ÌÖåÏù¥Ïßï** | development | staging.myapp.com | QA Î∞è ÌÜµÌï© ÌÖåÏä§Ìä∏ |
| **ÌîÑÎ°úÎçïÏÖò** | main        | myapp.com         | Ïã§Ï†ú ÏÑúÎπÑÏä§ Ïö¥ÏòÅ  |

### ÏÑúÎ≤Ñ Íµ¨ÏÑ±

#### Ïä§ÌÖåÏù¥Ïßï ÌôòÍ≤Ω

```yaml
# docker-compose.staging.yml
version: "3.8"
services:
  web:
    image: node:18-alpine
    environment:
      - NODE_ENV=development
      - NEXT_PUBLIC_API_URL=https://staging-api.myapp.com
    ports:
      - "3000:3000"

  api:
    image: node:18-alpine
    environment:
      - NODE_ENV=development
      - DATABASE_URL=${STAGING_DATABASE_URL}
      - REDIS_URL=${STAGING_REDIS_URL}
    ports:
      - "3001:3001"

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=cotept_staging
      - POSTGRES_USER=staging_user
      - POSTGRES_PASSWORD=${STAGING_DB_PASSWORD}

  redis:
    image: redis:7-alpine
```

#### ÌîÑÎ°úÎçïÏÖò ÌôòÍ≤Ω

```yaml
# docker-compose.production.yml
version: "3.8"
services:
  web:
    image: node:18-alpine
    environment:
      - NODE_ENV=production
      - NEXT_PUBLIC_API_URL=https://api.myapp.com
    ports:
      - "3000:3000"
    deploy:
      replicas: 2

  api:
    image: node:18-alpine
    environment:
      - NODE_ENV=production
      - DATABASE_URL=${PRODUCTION_DATABASE_URL}
      - REDIS_URL=${PRODUCTION_REDIS_URL}
    ports:
      - "3001:3001"
    deploy:
      replicas: 3

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=cotept_production
      - POSTGRES_USER=prod_user
      - POSTGRES_PASSWORD=${PRODUCTION_DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

volumes:
  postgres_data:
  redis_data:
```

## Î™®ÎãàÌÑ∞ÎßÅ Î∞è Î°§Î∞±

### Î∞∞Ìè¨ Î™®ÎãàÌÑ∞ÎßÅ

#### Health Check Ïä§ÌÅ¨Î¶ΩÌä∏

```bash
#!/bin/bash
# scripts/health-check.sh

ENV=${1:-staging}

if [ "$ENV" = "production" ]; then
  WEB_URL="https://myapp.com"
  API_URL="https://api.myapp.com"
else
  WEB_URL="https://staging.myapp.com"
  API_URL="https://staging-api.myapp.com"
fi

echo "üîç Checking health for $ENV environment..."

# Web App Health Check
echo "Checking Web App..."
if curl -f "$WEB_URL/health" > /dev/null 2>&1; then
  echo "‚úÖ Web App is healthy"
else
  echo "‚ùå Web App is down"
  exit 1
fi

# API Health Check
echo "Checking API..."
if curl -f "$API_URL/health" > /dev/null 2>&1; then
  echo "‚úÖ API is healthy"
else
  echo "‚ùå API is down"
  exit 1
fi

# Database Check
echo "Checking Database..."
if curl -f "$API_URL/health/db" > /dev/null 2>&1; then
  echo "‚úÖ Database is healthy"
else
  echo "‚ùå Database connection failed"
  exit 1
fi

echo "üéâ All services are healthy!"
```

#### Î∞∞Ìè¨ ÌõÑ ÏûêÎèô ÌÖåÏä§Ìä∏

```yaml
# .github/workflows/post-deploy.yml
name: Post Deploy Tests

on:
  workflow_run:
    workflows: ["Deploy Services"]
    types: [completed]

jobs:
  smoke-tests:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Wait for deployment
        run: sleep 60

      - name: Run smoke tests
        run: |
          ENV=${{ github.ref == 'refs/heads/main' && 'production' || 'staging' }}
          ./scripts/health-check.sh $ENV

      - name: Run E2E tests
        uses: cypress-io/github-action@v6
        with:
          config-file: cypress.config.js
          env: ${{ github.ref == 'refs/heads/main' && 'production' || 'staging' }}

      - name: Notify if tests fail
        if: failure()
        uses: 8398a7/action-slack@v3
        with:
          status: failure
          text: "üö® Post-deploy tests failed for ${{ github.ref }}"
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

### Î°§Î∞± Ï†ÑÎûµ

#### ÏûêÎèô Î°§Î∞± Ïä§ÌÅ¨Î¶ΩÌä∏

```bash
#!/bin/bash
# scripts/rollback.sh

ENV=${1:-staging}
VERSION=${2}

if [ -z "$VERSION" ]; then
  echo "Usage: ./rollback.sh [staging|production] [version]"
  echo "Example: ./rollback.sh production v1.2.0"
  exit 1
fi

echo "üîÑ Rolling back $ENV to version $VERSION..."

if [ "$ENV" = "production" ]; then
  # ÌîÑÎ°úÎçïÏÖò Î°§Î∞±
  echo "Rolling back production..."
  git checkout main
  git reset --hard $VERSION
  git push origin main --force-with-lease
else
  # Ïä§ÌÖåÏù¥Ïßï Î°§Î∞±
  echo "Rolling back staging..."
  git checkout development
  git reset --hard $VERSION
  git push origin development --force-with-lease
fi

echo "‚úÖ Rollback completed. Deployment will trigger automatically."
```

#### GitHub Actions ÏàòÎèô Î°§Î∞±

```yaml
# .github/workflows/rollback.yml
name: Manual Rollback

on:
  workflow_dispatch:
    inputs:
      environment:
        description: "Environment to rollback"
        required: true
        type: choice
        options:
          - staging
          - production
      version:
        description: "Version to rollback to (e.g., v1.2.0)"
        required: true
        type: string

jobs:
  rollback:
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Rollback to version
        run: |
          BRANCH=${{ inputs.environment == 'production' && 'main' || 'development' }}
          git checkout $BRANCH
          git reset --hard ${{ inputs.version }}
          git push origin $BRANCH --force-with-lease

      - name: Notify rollback
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              "text": "üîÑ Rollback completed",
              "attachments": [
                {
                  "color": "warning",
                  "fields": [
                    {
                      "title": "Environment",
                      "value": "${{ inputs.environment }}",
                      "short": true
                    },
                    {
                      "title": "Version",
                      "value": "${{ inputs.version }}",
                      "short": true
                    }
                  ]
                }
              ]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

## Î™®ÎãàÌÑ∞ÎßÅ ÎèÑÍµ¨ ÏÑ§Ï†ï

### Sentry ÏóêÎü¨ Ï∂îÏ†Å

```typescript
// apps/web/src/lib/sentry.ts
import * as Sentry from "@sentry/nextjs"

const SENTRY_DSN = process.env.NEXT_PUBLIC_SENTRY_DSN

Sentry.init({
  dsn: SENTRY_DSN,
  environment: process.env.NEXT_PUBLIC_ENV,
  tracesSampleRate: 1.0,
  beforeSend(event) {
    // ÌîÑÎ°úÎçïÏÖòÏóêÏÑúÎßå ÏóêÎü¨ Ï†ÑÏÜ°
    if (process.env.NEXT_PUBLIC_ENV !== "production") {
      return null
    }
    return event
  },
})
```

### Slack ÏïåÎ¶º ÏÑ§Ï†ï

```yaml
# .github/workflows/notify.yml
name: Deployment Notifications

on:
  workflow_run:
    workflows: ["Deploy Services"]
    types: [completed]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Notify deployment success
        if: ${{ github.event.workflow_run.conclusion == 'success' }}
        uses: 8398a7/action-slack@v3
        with:
          status: success
          channel: "#deployments"
          text: "‚úÖ Deployment successful"
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}

      - name: Notify deployment failure
        if: ${{ github.event.workflow_run.conclusion == 'failure' }}
        uses: 8398a7/action-slack@v3
        with:
          status: failure
          channel: "#deployments"
          text: "‚ùå Deployment failed"
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

## ÏöîÏïΩ Î∞è Í∂åÏû•ÏÇ¨Ìï≠

### üéØ ÏµúÏ¢Ö Í∂åÏû• Ï†ÑÎûµ

1. **Git Flow + Path-based Î∞∞Ìè¨**

   - `main` (ÌîÑÎ°úÎçïÏÖò) ‚Üê `development` (Ïä§ÌÖåÏù¥Ïßï)
   - Î≥ÄÍ≤ΩÎêú ÏÑúÎπÑÏä§Îßå ÏÑ†ÌÉùÏ†Å Î∞∞Ìè¨
   - Î∏åÎûúÏπò Î≥¥Ìò∏ Í∑úÏπô Ï†ÅÏö©

2. **ÌôòÍ≤ΩÎ≥Ñ ÏûêÎèô Î∞∞Ìè¨**

   - `development` ‚Üí Ïä§ÌÖåÏù¥Ïßï ÏûêÎèô Î∞∞Ìè¨
   - `main` ‚Üí ÌîÑÎ°úÎçïÏÖò ÏûêÎèô Î∞∞Ìè¨
   - Î∞∞Ìè¨ ÌõÑ ÏûêÎèô Ìó¨Ïä§Ï≤¥ÌÅ¨

3. **Î™®ÎãàÌÑ∞ÎßÅ Î∞è ÏïåÎ¶º**

   - SentryÎ°ú ÏóêÎü¨ Ï∂îÏ†Å
   - SlackÏúºÎ°ú Î∞∞Ìè¨ ÏÉÅÌÉú ÏïåÎ¶º
   - ÏûêÎèô/ÏàòÎèô Î°§Î∞± ÏßÄÏõê

4. **Î≥¥Ïïà Î∞è ÌíàÏßà Í¥ÄÎ¶¨**
   - Î∏åÎûúÏπò Î≥¥Ìò∏ Í∑úÏπô
   - ÏΩîÎìú Î¶¨Î∑∞ ÌïÑÏàò
   - ÏûêÎèôÌôîÎêú ÌÖåÏä§Ìä∏ Î∞è Î¶∞Ìä∏

### üîß ÎèÑÏûÖ ÏàúÏÑú

1. **1Îã®Í≥Ñ**: Î∏åÎûúÏπò Î≥¥Ìò∏ Í∑úÏπô ÏÑ§Ï†ï
2. **2Îã®Í≥Ñ**: Í∏∞Î≥∏ CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Íµ¨Ï∂ï
3. **3Îã®Í≥Ñ**: Î≥ÄÍ≤Ω Í∞êÏßÄ Î∞è ÏÑ†ÌÉùÏ†Å Î∞∞Ìè¨
4. **4Îã®Í≥Ñ**: Î™®ÎãàÌÑ∞ÎßÅ Î∞è ÏïåÎ¶º ÏãúÏä§ÌÖú
5. **5Îã®Í≥Ñ**: Î°§Î∞± Î∞è Î≥µÍµ¨ ÏãúÏä§ÌÖú

Ïù¥ Íµ¨Ï°∞Î°ú ÏïàÏ†ÑÌïòÍ≥† Ìö®Ïú®Ï†ÅÏù∏ Î™®ÎÖ∏Î†àÌè¨ Í¥ÄÎ¶¨Í∞Ä Í∞ÄÎä•Ìï©ÎãàÎã§! üöÄ

Î™®ÎÖ∏Î†àÌè¨ Î∏åÎûúÏπò Ï†ÑÎûµ ÏòµÏÖò

1. üìÅ ÏÑúÎπÑÏä§Î≥Ñ Î∏åÎûúÏπò Ï†ÑÎûµ

main (Î™®Îì† ÏÑúÎπÑÏä§ ÌîÑÎ°úÎçïÏÖò)
‚îú‚îÄ‚îÄ development (Î™®Îì† ÏÑúÎπÑÏä§ Í∞úÎ∞ú)
‚îú‚îÄ‚îÄ feature/web-user-auth
‚îú‚îÄ‚îÄ feature/api-payment-module
‚îú‚îÄ‚îÄ feature/mobile-push-notification
‚îî‚îÄ‚îÄ hotfix/web-security-patch

Ïû•Ï†ê:

- Îã®ÏàúÌïú Íµ¨Ï°∞
- Î™®Îì† ÏÑúÎπÑÏä§ ÎèôÏãú Î∞∞Ìè¨ Í∞ÄÎä•

Îã®Ï†ê:

- Ìïú ÏÑúÎπÑÏä§ Î≤ÑÍ∑∏Í∞Ä Ï†ÑÏ≤¥ Î∞∞Ìè¨ Î∏îÎ°úÌÇπ
- ÏÑúÎπÑÏä§Î≥Ñ ÎèÖÎ¶ΩÏ†Å Î∞∞Ìè¨ Ïñ¥Î†§ÏõÄ

2. üè∑Ô∏è ÌÉúÍ∑∏ Í∏∞Î∞ò Î∞∞Ìè¨ Ï†ÑÎûµ (Ï∂îÏ≤ú)

main
‚îú‚îÄ‚îÄ development
‚îú‚îÄ‚îÄ feature/web-dashboard
‚îú‚îÄ‚îÄ feature/api-auth-v2
‚îî‚îÄ‚îÄ release/web-v1.2.0
release/api-v2.1.0

ÌÉúÍ∑∏ ÏòàÏãú:

- web-v1.2.0 ‚Üí apps/web Î∞∞Ìè¨
- api-v2.1.0 ‚Üí apps/api Î∞∞Ìè¨
- mobile-v0.9.0 ‚Üí apps/mobile Î∞∞Ìè¨

3. üîÑ ÏÑúÎπÑÏä§Î≥Ñ ÎèÖÎ¶Ω Î∏åÎûúÏπò

main
‚îú‚îÄ‚îÄ web/main (Ïõπ ÌîÑÎ°úÎçïÏÖò)
‚îú‚îÄ‚îÄ web/development (Ïõπ Í∞úÎ∞ú)
‚îú‚îÄ‚îÄ api/main (API ÌîÑÎ°úÎçïÏÖò)
‚îú‚îÄ‚îÄ api/development (API Í∞úÎ∞ú)
‚îî‚îÄ‚îÄ shared/main (Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨)

Í∂åÏû• Ï†ÑÎûµ: Git Flow + Monorepo

gitGraph
commit id: "Initial"
branch development
commit id: "Setup monorepo"

      branch feature/web-auth
      commit id: "Add web auth"
      checkout development
      merge feature/web-auth

      branch feature/api-users
      commit id: "Add user API"
      checkout development
      merge feature/api-users

      checkout main
      merge development tag: "v1.0.0"

Î∏åÎûúÏπò Íµ¨Ï°∞

main # Î™®Îì† ÏÑúÎπÑÏä§ ÏïàÏ†ï Î≤ÑÏ†Ñ
‚îú‚îÄ‚îÄ development # ÌÜµÌï© Í∞úÎ∞ú Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ feature/web-_ # Ïõπ Í∏∞Îä• Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ feature/api-_ # API Í∏∞Îä• Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ feature/shared-_ # Í≥µÌÜµ ÎùºÏù¥Î∏åÎü¨Î¶¨ Î∏åÎûúÏπò
‚îú‚îÄ‚îÄ hotfix/_ # Í∏¥Í∏â ÏàòÏ†ï
‚îî‚îÄ‚îÄ release/\* # Î¶¥Î¶¨Ïä§ Ï§ÄÎπÑ

CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ ÏÑ§Ï†ï

GitHub Actions ÏòàÏãú

# .github/workflows/deploy.yml

name: Deploy Services

on:
push:
branches: [main, development]
tags: ['web-v*', 'api-v*']

jobs:
detect-changes:
runs-on: ubuntu-latest
outputs:
web-changed: ${{ steps.changes.outputs.web }}
api-changed: ${{ steps.changes.outputs.api }}
steps: - uses: actions/checkout@v4 - uses: dorny/paths-filter@v2
id: changes
with:
filters: |
web: - 'apps/web/**' - 'packages/**'
api: - 'apps/api/**' - 'packages/**'

    deploy-web:
      needs: detect-changes
      if: needs.detect-changes.outputs.web-changed == 'true'
      runs-on: ubuntu-latest
      steps:
        - name: Deploy Web App
          run: |
            if [[ "${{ github.ref }}" == "refs/heads/main" ]]; then
              echo "Deploying web to production"
            elif [[ "${{ github.ref }}" == "refs/heads/development" ]]; then
              echo "Deploying web to staging"
            fi

    deploy-api:
      needs: detect-changes
      if: needs.detect-changes.outputs.api-changed == 'true'
      runs-on: ubuntu-latest
      steps:
        - name: Deploy API
          run: |
            if [[ "${{ github.ref }}" == "refs/heads/main" ]]; then
              echo "Deploying API to production"
            elif [[ "${{ github.ref }}" == "refs/heads/development" ]]; then
              echo "Deploying API to staging"
            fi

ÌôòÍ≤ΩÎ≥ÄÏàò Í¥ÄÎ¶¨ Ï†ÑÎûµ

1. ÏÑúÎπÑÏä§Î≥Ñ ÌôòÍ≤ΩÎ≥ÄÏàò

# apps/web/.env.production

NEXT_PUBLIC_API_URL=https://api.myapp.com
NEXT_PUBLIC_WEB_VERSION=1.2.0

# apps/api/.env.production

DATABASE_URL=postgresql://prod-db
API_VERSION=2.1.0

2. Í≥µÌÜµ ÌôòÍ≤ΩÎ≥ÄÏàò

# .env.production (Î£®Ìä∏)

SHARED_SECRET=common-secret
LOG_LEVEL=info

# packages/shared/.env

SHARED_CONFIG=production

Ïã§Ï†ú ÏõåÌÅ¨ÌîåÎ°úÏö∞

Í∞úÎ∞ú Í≥ºÏ†ï

# 1. ÌîºÏ≤ò Î∏åÎûúÏπò ÏÉùÏÑ±

git checkout -b feature/web-user-dashboard

# 2. Í∞úÎ∞ú ÏôÑÎ£å ÌõÑ developmentÏóê Î®∏ÏßÄ

git checkout development
git merge feature/web-user-dashboard

# 3. Ïä§ÌÖåÏù¥Ïßï Î∞∞Ìè¨ (ÏûêÎèô)

# development Î∏åÎûúÏπò ‚Üí staging ÌôòÍ≤Ω

# 4. QA ÏôÑÎ£å ÌõÑ mainÏóê Î®∏ÏßÄ

git checkout main
git merge development

# 5. ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ (ÏûêÎèô)

# main Î∏åÎûúÏπò ‚Üí production ÌôòÍ≤Ω

Í∏¥Í∏â ÏàòÏ†ï

# 1. mainÏóêÏÑú Ìï´ÌîΩÏä§ Î∏åÎûúÏπò ÏÉùÏÑ±

git checkout main
git checkout -b hotfix/web-security-fix

# 2. ÏàòÏ†ï ÌõÑ mainÏóê ÏßÅÏ†ë Î®∏ÏßÄ

git checkout main
git merge hotfix/web-security-fix

# 3. developmentÏóêÎèÑ Î∞±Ìè¨Ìä∏

git checkout development
git merge hotfix/web-security-fix

Í∂åÏû• Ï†ÑÎûµ ÏöîÏïΩ

üéØ ÏµúÏ¢Ö Ï∂îÏ≤ú:

1. Git Flow + Path-based Î∞∞Ìè¨
2. development ‚Üí staging ÏûêÎèô Î∞∞Ìè¨
3. main ‚Üí production ÏûêÎèô Î∞∞Ìè¨
4. Î≥ÄÍ≤ΩÎêú ÏÑúÎπÑÏä§Îßå ÏÑ†ÌÉùÏ†Å Î∞∞Ìè¨
5. ÌÉúÍ∑∏ Í∏∞Î∞ò ÏàòÎèô Î°§Î∞± ÏßÄÏõê

Ïù¥ Íµ¨Ï°∞Í∞Ä Í∞ÄÏû• ÏïàÏ†ÑÌïòÍ≥† ÌôïÏû• Í∞ÄÎä•Ìï¥Ïöî!
